
\documentclass{article}

\usepackage{a4wide}
\usepackage[utf8]{inputenc}
\usepackage{enumerate}
\usepackage{xspace}
\usepackage{longtable}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{calc}
\usepackage{lmodern}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathdots}
\usepackage{mathtools}
\usepackage{multicol}
\usepackage{enumitem}
\usepackage{tasks}
\usepackage{pdfpages}
\usepackage{listings}
\usepackage{bera}

\lstset{basicstyle=\ttfamily,
escapeinside={||},
mathescape=true}

\input{../macros/Algo1Macros}

\begin{document}

%\practica{4}{Precondición más débil en SmallLang}
\includepdf[pages=-]{practica5.pdf}

\begin{center}
\section*{RESOLUCIONES.}
\end{center}

\paragraph{Ejercicio 1}
\begin{enumerate}[label=\alph*)]
\item
	\begin{align*}
		P_c&: \{result=0\wedge i=0\}\\
		Q_c&: \{result=\sum_{j=0}^{|s|-1}s[j]\}
	\end{align*}
\item Si le sacas el igual a la segunda desigualdad no te agarra el ultimo elemento la 
	sumatoria.
\item Si le sacas el -1 al supraindice de la sumatoria entonces va a tratar de sumar la posicion del tamaño
	de la secuencia, como la secuencia no posee esta posicion se va a indefinir el resultado.
\item Si invertis de lugar las instrucciones del cuerpo del ciclo entonces no te agarra el primer elemento de la 
secuencia.
\item 
	Vamos  a demostrar los primeros 3 puntos del teorema del invariante. Esto nos permite afirmar que el ciclo, si termina entonces
	es correcto respecto a su especificacón. Especificacion del ciclo:
	\begin{itemize}
		\item $P_c: result=0 \wedge i=0$
		\item $Q_c:r esult=\sum_{j=0}^{|s|-1}s[j] $
		\item $I\equiv 0\leq i\leq |s| \wedge_L result=\sum_{j=0}^
			{i-1}s[j]$
	\end{itemize}
	\begin{flushleft}$\scalebox{1.3}{$P_c\Rightarrow I$}$\end{flushleft}
	Tenemos que vale $P_c$ como hipótesis. Queremos probar que vale I. Vamos a probarlo por partes:
	\begin{itemize}
		\item Queremos ver que vale $ 0\leq i\leq |s|$\smallskip \\
		Sabemos que i=0 (es información que nos da $P_c$). Entonces reemplazando, lo que queremos ver es que 
		$0\leq 0\leq |s|$. La primera parte, $0\leq 0$, es una tautología. Nos resta ver si $0\leq |s|$. Pero si la lista es
		vacia entonces $0\leq 0$, caso contrario si la lista fuera no vacia entonces $|s|>0$ y la desigualdad $0\leq |s|$ 
		se cumple.
		\item Queremos ver que $result=\sum_{j=0}^{i-1}s[j]$\\
		Como $i=0$, entonces $\sum_{j=0}^{i-1}s[j]=0=result$.
	\end{itemize}	 
	$\scalebox{1.3}{$(I\wedge \neg B)\Rightarrow Q_c$}$\smallskip \\
	Queremos demostrar que vale $Q_c$, asumiendo que valen tanto $I$ como $\neg B$.\\ Es decir, queremos probar que 
	$result =\sum_{j=0}^{|s|-1}s[j]$\\
	Como sabemos que vale $I$, podemos afirmar que $0\leq i\leq |s|$.\\ Además sabemos que vale $\neg B\equiv i\geq |s|$.
	\\ Luego $|s|\leq i\leq |s|$, entonces el unico valor que cumple esta condición es $i=|s|$. Analicemoslo.\\
	\begin{itemize}
	\item $i=|s|$
	\end{itemize}
	En este caso, podemos reemplazar $i$ por $|s|$ en la sumatoria del invariante y llegamos a $result =\sum_{j=0}^{|s|-1}s[j]$, exactamante lo que queríamos probar.\medskip \\
	$\scalebox{1.3}{$\{I\wedge B\} \textbf{ ciclo } \{I\}$}$\medskip \\
	Queremos ver que vale la siguiente tripla de Hoare $\{I\wedge B\} \textbf{ ciclo } \{I\}$.\\
	Llamemos S1 a la primer instrucción del cuerpo del ciclo, S2 a la segunda:\\
	S1$: result:=result+s[i];$\\
	S2$: i:=i+1$\\
	Lo primero que haremos es calcular $wp(ciclo,I)$.
	\begin{equation}wp(S1;S2,I)\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\end{equation}
	Antes de seguir, debemos calcular $wp(S2,I)$. Para eso usaremos el axioma 1:
	\begin{align*}
	wp(S2,I)&\stackrel{Ax1}{\equiv}def(i+1)\wedge_L I_{i+1}^{i}\\
		&true\wedge_L (0\leq i+1\leq |s| \wedge_L result=\sum_{j=0}^{i+1-1}s[j])\\
		& (0\leq i+1\leq |s| \wedge_L result=\sum_{j=0}^{i+1-1}s[j])
	\end{align*}
	Volviendo a (1), reemplazamos $wp(S2,I)$ y nos queda:
	\begin{align*}
	wp(S1;S2,I)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\equiv wp(S1,0\leq i+1\leq |s| \wedge_L result=\sum_{j=0}^{i+1-1}s[j])\\
		&\stackrel{Ax1}{\equiv}def(result+s[i])\wedge_L 0\leq i+1\leq |s| \wedge_L result+s[i]=\sum_{j=0}^{i}s[j]\\
		&\equiv 0\leq i<|s|\wedge_L 0\leq i+1\leq |s| \wedge_L result+s[i]=\sum_{j=0}^{i}s[j]\\
		&\equiv 0\leq i<|s| \wedge_L result=\sum_{j=0}^{i}s[j]-s[i]\\
		&\equiv 0\leq i<|s| \wedge_L result=\sum_{j=0}^{i-1}s[j]
	\end{align*}
	Una vez calculada la precondición más débil, debemos ver si $(I\wedge B)$ implican dicha precondición. Probamos cada
	parte por separado:
	\begin{itemize}
		\item $ 0\leq i< |s|$\smallskip \\
		Sabemos por $I$ que $0\leq i$, entonces la primera parte ya esta demostrada, ahora la interseccion entre la guarda
		y el invariante da como cota superior $i<|s|$, que es lo mismo que tengo en mi $wp$.
		\item $result=\sum_{j=0}^{i-1}s[j]$\smallskip \\
		Este $result$ es igual al del $I$.
		Como $(I\wedge B) \Rightarrow wp(ciclo,I)$, podemos afirmar que el cuerpo del ciclo preserva el invariante.
	\end{itemize}
	\item 
	Vamos  a demostrar los ultimos 2 puntos del teorema del invariante. Esto nos permite afirmar que el ciclo termina. Especificación del ciclo:
	\begin{itemize}
	\item $f_v:|s|-i$
	\end{itemize}
	$\scalebox{1.3}{$\{(I\wedge B\wedge v_0=f_v)\}\textbf{ ciclo }\{(f_v<v_0)\}$}$\medskip \\
	Dado que queremos demostrar que vale una tripla de Hoare, comenzaremos calculando la\\ precondición más débil $wp(ciclo,f_v<v_0)$.
	\begin{align*}
		wp(S1;S2,f_v<v_0)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,|s|-i<v_0))\\
			&\stackrel{Ax1}{\equiv}wp(S1,true\wedge_L |s|-(i+1)<v_0)\\
			&\stackrel{Ax3}{\equiv}true\wedge_L(true\wedge_L  |s|-(i+1)<v_0)\\
			&\equiv |s|-i-1<v_0
	\end{align*}
	Es decir, $wp(S1;S2,f_v<v_0)=|s|-i-1<v_0$. Ahora debemos ver que $(I\wedge B\wedge v_0=f_v)$ implican dicha WP. Parte de la 
	hipótesis es que $v_0=f_v$, es decir $v_0=|s|-i$. Restando 1 a ambos lados, $|s|-1-i=v_0-1<v_0$.\medskip \\
	$\scalebox{1.3}{$(I\wedge f_v\leq 0)\Rightarrow \neg B$}$\medskip\\
	Debemos mostrar que vale $\neg B$, es decir $i\geq |s|$.\\
	Sabemos que $f_v\leq 0$, es decir $|s|-i\leq 0$, luego $|s|\leq i$, como queriamos demostrar.
\end{enumerate}





\paragraph{Ejercicio 2}

Vamos  a demostrar los 5 puntos del teorema del invariante. Esto nos permite afirmar que el ciclo termina y es correcto
	 respecto a su especificacón (no demuestra que el programa entero sea correcto!). Especificacion del ciclo:
	\begin{itemize}
		\item $P_c: n\geq 0\wedge result=0 \wedge i=0$
		\item $Q_c:result=\sum_{j=0}^{n-1} $(if $j$ mod 2=0 then $j$ else 0 fi)
		\item $I\equiv 0\leq i\leq n+1\wedge i \textrm{ mod }2=0 \wedge result=\sum_{j=0}^{i-1}$(if $j$ mod 2=0 then $j$ else 0 fi)
		\item $f_v:n-i$
	\end{itemize}
	\begin{flushleft}$\scalebox{1.3}{$P_c\Rightarrow I$}$\end{flushleft}
	Tenemos que vale $P_c$ como hipótesis. Queremos probar que vale I. Vamos a probarlo por partes:
	\begin{itemize}
		\item Queremos ver que vale $ 0\leq i\leq n+1$\smallskip \\
		Sabemos que i=0 (es información que nos da $P_c$). Entonces reemplazando, lo que queremos ver es que 
		$0\leq 0\leq n+1$. La primera parte, $0\leq 0$, es una tautología. Nos resta ver si $0\leq n+1$. Pero $P_c$
		indica también que $n\leq 0$, luego $n+i\leq 1\leq 0$.
		\item Queremos ver que vale$i$ mod $2=0$\\
		Sabemos que $i=0$,luego podemos afirmar que $i$ mod $2=0$.
		\item Queremos ver que $result=\sum_{j=0}^{i-1}$(if $j$ mod 2=0 then $j$ else 0 fi)\\
		Como $i=0$, $result=\sum_{j=0}^{i-1}$(if $j$ mod 2=0 then $j$ else 0 fi)=$result=\sum_{j=0}^{-1}$(if $j$ mod 2=0 then $j$ else 0 fi).
		 Recordemos que si el rango de una sumatoria es vacío (como en este caso), la sumatoria tiene valor 0. Luego 
		 $result=\sum_{j=0}^{i-1}$(if $j$ mod 2=0 then $j$ else 0 fi)=0. Pero además sabemos que result = 0 (por $P_c$), asi que podemos
		  afirmar que 0=result=$result=\sum_{j=0}^{i-1}$(if $j$ mod 2=0 then $j$ else 0 fi)=0
	\end{itemize}	 
	$\scalebox{1.3}{$(I\wedge \neg B)\Rightarrow Q_c$}$\smallskip \\
	Queremos demostrar que vale $Q_c$, asumiendo que valen tanto $I$ como $\neg B$.\\ Es decir, queremos probar que 
	$result=\sum_{j=0}^{n-1}$(if $j$ mod 2=0 then $j$ else 0 fi)\\
	Como sabemos que vale $I$, podemos afirmar que $0\leq i\leq n+1$.\\ Además sabemos que vale $\neg B\equiv i\geq n$.
	\\ Luego $n\leq i\leq n+1$. Hay dos valores de $i$ que cumplen esa condición. Analicemos ambos casos:\\
	\begin{itemize}
	\item $i=n$
	\end{itemize}
	En este caso, podemos reemplazar $i$ por $n$ en la parte de la sumatoria del invariante y llegamos a
	 $result=\sum_{j=0}^{n-1}$(if $j$ mod 2=0 then $j$ else 0 fi), exactamante lo que queríamos probar.
	 \begin{itemize}
	\item $i=n+1$
	\end{itemize}
	En este caso, su hacemos el reemplazo, llegamos a  
	$result=\sum_{j=0}^{n}$(if $j$ mod 2=0 then $j$ else 0 fi) (y esto no es a lo que queremos llegar!).\\
	$result=\sum_{j=0}^{n}$(if $j$ mod 2=0 then $j$ else 0 fi) =$result=\sum_{j=0}^{n-1}$(if $j$ mod 2=0 then $j$ else 0 fi) 
	+(if $n$ mod 2=0 then $j$ else 0 fi). Sabemos además que $i$ mod 2=0 (información del invariante). Pero estamos en el caso en el cual
	 $i=n+1$. Entonces podemos afirmar que si $i$ es par, $n$ es impar. Luego $n$ no cumple la guada del IF y podemos afirmar que 
	 (if $n$ mod 2=0 then $j$ else 0 fi) = 0.\\
	 $result=\sum_{j=0}^{n}$(if $j$ mod 2=0 then $j$ else 0 fi) =$result=\sum_{j=0}^{n-1}$(if $j$ mod 2=0 then $j$ else 0 fi) +0.\medskip\\
	$\scalebox{1.3}{$\{I\wedge B\} \textbf{ ciclo } \{I\}$}$\medskip \\
	Queremos ver que vale la siguiente tripla de Hoare $\{I\wedge B\} \textbf{ ciclo } \{I\}$.\\
	Llamemos S1 a la primer instrucción del cuerpo del ciclo, S2 a la segunda:\\
	S1$: result:=result+i;$\\
	S2$: i:=i+2$\\
	Lo primero que haremos es calcular $wp(ciclo,I)$.
	\begin{equation}wp(S1;S2,I)\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\end{equation}
	Antes de seguir, debemos calcular $wp(S2,I)$. Para eso usaremos el axioma 1:
	\begin{align*}
	wp(S2,I)&\stackrel{Ax1}{\equiv}def(i+2)\wedge_L I_{i+2}^{i}\\
		&\equiv true\wedge_L (0\leq i+2\leq n+1\wedge i+2\textrm{ mod }2=0 \wedge_L result=\sum_{j=0}^{i+2-1}\textrm{(if j mod 2=0 then j else 0 fi)})\\
		&\equiv (0\leq i+2\leq n+1\wedge i+2\textrm{ mod }2=0 \wedge_L result=\sum_{j=0}^{i+1}\textrm{(if j mod 2=0 then j else 0 fi)})
	\end{align*}
	Volviendo a (2), reemplazamos $wp(S2,I)$ y nos queda:
	\begin{align*}
	wp(S1;S2,I)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\equiv wp(S1,0\leq i+2\leq n+1 \wedge i+2\textrm{ mod }2=0 
			\wedge result=\sum_{j=0}^{i+1}\textrm{(if j mod 2=0 then j else 0 fi)})\\
		&\stackrel{Ax1}{\equiv}def(result+i)\wedge_L (0\leq i+2\leq n+1 \wedge i+2\textrm{ mod }2=0
			 \wedge result=\sum_{j=0}^{i+1}\textrm{(if j mod 2=0 then j else 0 fi)})\\
		&\equiv true \wedge_L (0\leq i+2\leq n+1 \wedge i+2\textrm{ mod }2=0
			 \wedge result=\sum_{j=0}^{i+1}\textrm{(if j mod 2=0 then j else 0 fi)})\\
	\end{align*}
	Una vez calculada la precondición más débil, debemos ver si $(I\wedge B)$ implican dicha precondición. Probamos cada
	parte por separado:
	\begin{itemize}
		\item $ 0\leq i+2\leq n+1$\smallskip \\
		Sabemos por $I$ que $ i>0$, luego podemos afirmar que $0\leq i+2$\\
		Sabemos por $B$ que $i<n$, luego (sumando 2 en ambos términos): $i+2<n+2$, lo cual es equivalente a decir
		que $i+2\leq n+1$
		\item $i+2$ mod 2=0\smallskip \\
		Sabemos por $I$ que $i$ mod 2=0. Si $i$ es par, al sumarle 2 sigue siendo par, luego i +2 mod 2=0 vale. 
		\item $result+i=\sum_{j=0}^{i-1}\textrm{(if j mod 2=0 then j else 0 fi)}$\smallskip \\
		La sumatoria puede separarse en 3 términos:\\
		$\sum_{j=0}^{i-1}\textrm{(if j mod 2=0 then j else 0 fi)}+$\\
		if i mod 2=0 then i else 0 fi\\
		if i+1 mod 2=0 then i+1 else 0 fi\\
		El primero de los 3 términos es igual a $result$ (lo sabemos por $I$).\\
		El segundo término es $i$ (ya que por $I$ sabemos que $i$ es par).\\
		El tercer término es 0 (ya que por $I$ sabemos que $i$ es par, y por lo tanto $i+1$ es impar).\\
		Entonces sumando los 3 términos nos queda: $result +i+0$, que es lo que esperábamos que valiera la sumatoria 
		$\sum_{j=0}^{i+1}(...)$\\
		Como $(I\wedge B)\Rightarrow wp(ciclo,I)$,podemos afirmar que el cuerpo del ciclo preserva el invariante.
	\end{itemize}
	$\scalebox{1.3}{$\{(I\wedge B\wedge v_0=f_v)\}\textbf{ ciclo }\{(f_v<v_0)\}$}$\medskip \\
	Dado que queremos demostrar que vale una tripla de Hoare, comenzaremos calculando la\\ precondición más débil $wp(ciclo,f_v<v_0)$.
	\begin{align*}
		wp(S1;S2,f_v<v_0)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,n-i<v_0))\\
			&\stackrel{Ax1}{\equiv}wp(S1,true\wedge_L n-(i+2)<v_0)\\
			&\stackrel{Ax3}{\equiv}true\wedge_L(true\wedge_L  n-(i+2)<v_0)\\
			&\equiv n-i-2<v_0
	\end{align*}
	Es decir, $wp(S1;S2,f_v<v_0)=n-i-2<v_0$. Ahora debemos ver que $(I\wedge B\wedge v_0=f_v)$ implican dicha WP. Parte de la 
	hipótesis es que $v_0=f_v$, es decir $v_0=n-i$. Restando 2 a ambos lados, $n-i-2=v_0-2<v_0$.\medskip \\
	$\scalebox{1.3}{$(I\wedge f_v\leq 0)\Rightarrow \neg B$}$\medskip\\
	Debemos mostrar que vale $\neg B$, es decir $i\geq n$.\\
	Sabemos que $f_v\leq 0$, es decir $n-i\leq 0$, luego $n\leq i$, como queriamos demostrar.
	
	
	
	
	
\paragraph{Ejercicio 3\\}
\noindent
\textbf{proc exponenciacion}(in $s: \mathbb{Z}$,in $n:\mathbb{Z}$, out $result: \mathbb{Z})\ \{$\smallskip \\
\hspace*{6mm}\textbf{Pre}$\{ n\geq 0 \wedge \neg(m=0\wedge n=0)\}$\\
\hspace*{6mm}\textbf{Post}$\{ result=m^n\}$\\
$\}$\medskip\\

\noindent
\begin{enumerate}[label=\alph*)]
	\item 

\begin{lstlisting}
i:=1;
result:=m;

|\textbf{while}|(i<n) |\textbf{do}|
  result=:result*m;
  i:=i+1
|\textbf{endwhile}|
\end{lstlisting}

 Especificacion del ciclo:
	\begin{itemize}
		\item $P_c: result=m \wedge i=1\wedge n\geq 0 \wedge \neg(m=0\wedge n=0)$
		\item $Q_c:result=m^n$
		\item $I\equiv 1\leq i\leq n \wedge result=m^i$
		\item $f_v:n-i$
	\end{itemize}
	Solo demostraremos correción parcial de este ciclo.
	\begin{flushleft}$\scalebox{1.3}{$P_c\Rightarrow I$}$\end{flushleft}
	Debemos demostrar que vale $I$ sabiendo que vale $P_c$ 
	\begin{itemize}
		\item $ 1\leq i\leq n$\smallskip \\
		Por $P_c$ sabemos que $i=1$, entonces, la primera desigualdad es una tautologia,
		$1\leq 1$, para la segunda vemos que $n\geq0\wedge \neg(m=0 \wedge n=0)$, luego como 
		$n$, no puede ser 0 y es mayor o igual a cero tengo que $1\leq n$.
		\item  $result=m^i$\\
		Trivial, por $P_c$ $result=m$, y como $i=1$, entonces $m^i=m$, por lo que 
		 la igualdad vale.  
	\end{itemize}	 
	$\scalebox{1.3}{$(I\wedge \neg B)\Rightarrow Q_c$}$\smallskip \\
	Queremos demostrar que vale $Q_c$, asumiendo que vale  $I\wedge \neg B$.
	\begin{itemize}
	\item cuando deja de valer la guarda, $i=n$ sabemos por el invariante que $result=m^i$, como $i=n$, entonces,
	vale que $result=m^n$, que es exactamente lo mismo que $Q_c$
	\end{itemize}
	$\scalebox{1.3}{$\{I\wedge B\} \textbf{ ciclo } \{I\}$}$\medskip \\
	Queremos ver que vale la siguiente tripla de Hoare $\{I\wedge B\} \textbf{ ciclo } \{I\}$.\\
	Llamemos S1 a la primer instrucción del cuerpo del ciclo, S2 a la segunda:\\
	S1$: result:=result*m;$\\
	S2$: i:=i+1$\\
	Lo primero que haremos es calcular $wp(ciclo,I)$.
	\begin{equation}wp(S1;S2,I)\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\end{equation}
	Antes de seguir, debemos calcular $wp(S2,I)$. Para eso usaremos el axioma 1:
	\begin{align*}
	wp(S2,I)&\stackrel{Ax1}{\equiv}def(i+1)\wedge_L I_{i+1}^{i}\\
		&\equiv true\wedge_L (1\leq i+1\leq n \wedge_L result=m^{i+1})\\
		&\equiv (1\leq i+1\leq n \wedge_L result=m^{i+1})
	\end{align*}
	Volviendo a (3), reemplazamos $wp(S2,I)$ y nos queda:
	\begin{align*}
	wp(S1;S2,I)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\equiv wp(S1,1\leq i+1\leq n \wedge_L result=m^{i+1})\\
		&\stackrel{Ax1}{\equiv}def(result*m)\wedge_L 1\leq i+1\leq n \wedge_L result*m=m^{i+1}\\
		&\equiv 1\leq i+1\leq n \wedge_L result*m=m^{i+1}
	\end{align*}
	Una vez calculada la precondición más débil, debemos ver si $(I\wedge B)$ implican dicha precondición. Probamos cada
	parte por separado:
	\begin{itemize}
		\item $ 0\leq i+1\leq n$\smallskip \\
		Sabemos por $I$ que $ i>0$, luego podemos afirmar que $1\leq i+1$\\
		Sabemos por $B$ que $i<n$, luego $i+1\geq n$.
		\item $result*m=m^{i+1}$\smallskip \\
		Divido en ambos miembros por $m$, y tengo lo mismo que en mi invariante.\smallskip \\
		Como $(I\wedge B) \Rightarrow wp(ciclo,I)$, podemos afirmar que el cuerpo del ciclo preserva el invariante.
	\end{itemize}
	$\scalebox{1.3}{$\{(I\wedge B\wedge v_0=f_v)\}\textbf{ ciclo }\{(f_v<v_0)\}$}$\medskip \\
	Dado que queremos demostrar que vale una tripla de Hoare, comenzaremos calculando la\\ precondición más débil $wp(ciclo,f_v<v_0)$.
	\begin{align*}
		wp(S1;S2,f_v<v_0)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,n-i<v_0))\\
			&\stackrel{Ax1}{\equiv}wp(S1,true\wedge_L n-(i+1)<v_0)\\
			&\stackrel{Ax3}{\equiv}true\wedge_L(true\wedge_L  n-(i+1)<v_0)\\
			&\equiv n-i-1<v_0
	\end{align*}
	Es decir, $wp(S1;S2,f_v<v_0)=n-i-1<v_0$. Ahora debemos ver que $(I\wedge B\wedge v_0=f_v)$ implican dicha WP. Parte de la 
	hipótesis es que $v_0=f_v$, es decir $v_0=n-i$. Restando 1 a ambos lados, $n-1-i=v_0-1<v_0$.\medskip \\
	$\scalebox{1.3}{$(I\wedge f_v\leq 0)\Rightarrow \neg B$}$\medskip\\
	Debemos mostrar que vale $\neg B$, es decir $i\geq n$.\\
	Sabemos que $f_v\leq 0$, es decir $n-i\leq 0$, luego $n\leq i$, como queriamos demostrar.
	
	\item falla el primero, el segundo el tercero el cuarto y el quinto, falla todo para ser más preciso.
	\item creo que no falla, empieza con el caso $m^0=1$, y sigue como en mi demostración en a), no lo
	voy a probar de vuelta.
	\item habria que agregar en la pre que $n\geq 2$.
\end{enumerate}

\paragraph{Ejercicio 4\\}
\noindent
\textbf{proc sumaDivisores}(in $n: \mathbb{Z}$, out $result: \mathbb{Z})\ \{$\smallskip \\
\hspace*{6mm}\textbf{Pre}$\{ n\geq 1 \}$\\
\hspace*{6mm}\textbf{Post}$\{ result=\sum_{j=1}^{n}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})\}$\\
$\}$\medskip\\

\noindent
\begin{enumerate}[label=\alph*)]
	\item 

\begin{lstlisting}
i:=0;
result:=0;

|\textbf{while}|(i<n) |\textbf{do}|
  i:=i+1
  |\textbf{if}| (n mod i = 0) 
     result=:result +i
  |\textbf{else}|
     skip
  |\textbf{endif}|;
|\textbf{endwhile}|
\end{lstlisting}
	\item
	
 Especificacion del ciclo:
	\begin{itemize}
		\item $P_c: result=0 \wedge i=0\wedge n\geq 1$
		\item $Q_c:result=\sum_{j=1}^{n}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})$
		\item $I\equiv 1\leq i\leq n \wedge result=\sum_{j=1}^{i}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})$
		\item $f_v:n-i$
	\end{itemize}
	
	Solo demostraremos correción parcial de este ciclo.
	\begin{flushleft}$\scalebox{1.3}{$P_c\Rightarrow I$}$\end{flushleft}
	Debemos demostrar que vale $I$ sabiendo que vale $P_c$ 
	\begin{itemize}
		\item $ 1\leq i\leq n$\smallskip \\
		Por $P_c$ sabemos que $i=1$, entonces, la primera desigualdad es una tautologia,
		$1\leq 1$, para la segunda vemos que $n\geq 1$, luego como 
		$n$, no puede ser 0 y es mayor o igual a 1 tengo que $1\leq n$.
		\item  $result=\sum_{j=1}^{i}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})$\\
		Trivial, por $P_c$ $result=0$, y  como $i=0$, entonces
		 $\sum_{j=1}^{0}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})=result=0$.
	\end{itemize}	 
	$\scalebox{1.3}{$(I\wedge \neg B)\Rightarrow Q_c$}$\smallskip \\
	Queremos demostrar que vale $Q_c$, asumiendo que vale  $I\wedge \neg B$.
	\begin{itemize}
	\item cuando deja de valer la guarda, $i=n$ sabemos por el invariante que $result=\sum_{j=1}^{i}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})$, como $i=n$, entonces,
	vale que $result=\sum_{j=1}^{n}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})$, que es exactamente lo mismo que $Q_c$
	\end{itemize}
	$\scalebox{1.3}{$\{I\wedge B\} \textbf{ ciclo } \{I\}$}$\medskip \\
	Queremos ver que vale la siguiente tripla de Hoare $\{I\wedge B\} \textbf{ ciclo } \{I\}$.\\
	Llamemos S1 a la primer instrucción del cuerpo del ciclo, S2 a la segunda:\\
	S1$: i:=i+1$\\
	S2$: \textbf{if}\ (n\ mod\ i=0)\ \textbf{then}\ result:=result+i\ \textbf{else}\ skip\ \textbf{endif};$\\
	Lo primero que haremos es calcular $wp(ciclo,I)$.
	\begin{equation}wp(S1;S2,I)\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\end{equation}
	Antes de seguir, debemos calcular $wp(S2,I)$. Para eso usaremos el axioma 1:
	\begin{align*}
	wp(S2,I)&\stackrel{Ax4}{\equiv}def(n\ mod\ i=0)\wedge_L \Bigg(\Big((n\ mod\ i=0)\wedge (wp(result:=result+i,I))\Big) 
   				\vee \Big(\neg  (n\ mod\ i=0)\wedge (wp(skip,I))\Big)\Bigg)\\
		&\equiv True \wedge_L \Bigg(\Big((n\ mod\ i=0)\wedge (def(result+i)\wedge_LI_{result+i}^{result}))\Big) 
   				\vee \Big(\neg  (n\ mod\ i=0)\wedge (I)\Big)\Bigg)\\
		&\equiv \Bigg(\Big((n\ mod\ i=0)\wedge (I_{result+i}^{result}))\Big) 
   				\vee \Big(\neg  (n\ mod\ i=0)\wedge (I)\Big)\Bigg)\\
	\end{align*}
	Volviendo a (4), reemplazamos $wp(S2,I)$ y nos queda:
	\begin{align*}
	wp(S1;S2,I)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\\
	&\equiv  wp(S1,\Big((n\ mod\ i=0)\wedge (1\leq i\leq n \wedge result+1=\sum_{j=1}^{i}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})))\Big) 
   				\\ &\vee \Big(\neg  (n\ mod\ i=0)\wedge (1\leq i\leq n \wedge result=\sum_{j=1}^{i}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi}))\Big))\\
		&\stackrel{Ax1}{\equiv}def(i+1)\wedge_L \Big((n\ mod\ i+1=0)\wedge (1\leq i+1\leq n \wedge result+1=\sum_{j=1}^{i+1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})))\Big) 
   				\\ &\vee \Big(\neg  (n\ mod\ i+1=0)\wedge (1\leq i+1\leq n \wedge result=\sum_{j=1}^{i+1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi}))\Big))\\
		&\equiv  \Big((n\ mod\ i+1=0)\wedge (1\leq i+1\leq n \wedge result+1=\sum_{j=1}^{i+1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})))\Big) 
   				\\ &\vee \Big(\neg  (n\ mod\ i+1=0)\wedge (1\leq i+1\leq n \wedge result=\sum_{j=1}^{i+1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi}))\Big))\\
	\end{align*}
	Una vez calculada la precondición más débil, debemos ver si $(I\wedge B)$ implican dicha precondición. Probamos cada
	parte por separado:
	\begin{itemize}
		\item $\Big((n\ mod\ i+1=0)\wedge (1\leq i+1\leq n \wedge result+1=\sum_{j=1}^{i+1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})))\Big) $\smallskip \\
		Ya lo hice en la guia 4
		\item $\Big(\neg  (n\ mod\ i+1=0)\wedge (1\leq i+1\leq n \wedge result=\sum_{j=1}^{i+1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi}))\Big))$\smallskip \\
		Ya lo hice en la guia 4\smallskip \\
		Como $(I\wedge B) \Rightarrow wp(ciclo,I)$, podemos afirmar que el cuerpo del ciclo preserva el invariante.
	\end{itemize}
\end{enumerate}

\paragraph{Ejercicio 5\\}
\noindent
\textbf{proc sumaPosicionesImpares}(in $n: seq\langle\mathbb{Z}\rangle$, out $result: \mathbb{Z})\ \{$\smallskip \\
\hspace*{6mm}\textbf{Pre}$\{True \}$\\
\hspace*{6mm}\textbf{Post}$\{ result=\sum_{i=0}^{|s|-1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi})\}$\\
$\}$\medskip\\

\noindent
\begin{enumerate}[label=\alph*)]
	\item 

\begin{lstlisting}
j:=0;
result:=0;

|\textbf{while}|(j<s.size()) |\textbf{do}|
  |\textbf{if}| (j mod 2 = 1) 
     result=:result +s[j]
  |\textbf{else}|
     skip
  |\textbf{endif}|;
   j:=j+1
|\textbf{endwhile}|
\end{lstlisting}
	\item
	
 Especificacion del ciclo:
	\begin{itemize}
		\item $P_c: result=0 \wedge j=0$
		\item $Q_c: result=\sum_{i=0}^{|s|-1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))$
		\item $I\equiv 0\leq j\leq |s| \wedge result=\sum_{i=0}^{j-1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi})$
		\item $f_v:n-i$
	\end{itemize}
	
	Solo demostraremos correción parcial de este ciclo.
	\begin{flushleft}$\scalebox{1.3}{$P_c\Rightarrow I$}$\end{flushleft}
	Debemos demostrar que vale $I$ sabiendo que vale $P_c$ 
	\begin{itemize}
		\item $ 0\leq j\leq |s|$\smallskip \\
		Por $P_c$ sabemos que $j=0$, entonces, la primera desigualdad es una tautologia,
		$0\leq 0$, para la segunda vemos que $|s|\geq 0$, luego como 
		$|s|$, no puede ser menor que cero es valido.
		\item  $result=\sum_{i=0}^{j-1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi})$\\
		Trivial, por $P_c$ $result=0$, y  como $j=0$, entonces
		 $\sum_{i=0}^{-1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi})=result=0$.
	\end{itemize}	 
	$\scalebox{1.3}{$(I\wedge \neg B)\Rightarrow Q_c$}$\smallskip \\
	Queremos demostrar que vale $Q_c$, asumiendo que vale  $I\wedge \neg B$.
	\begin{itemize}
	\item cuando deja de valer la guarda, $j=|s|$ sabemos por el invariante que $result=\sum_{i=0}^{j-1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi})$, como $j=|s|$, entonces,
	vale que $result=\sum_{j=1}^{|s|-1}(\textrm{if}\ n\ mod\ j=0\ \textrm{then}\ j\ \textrm{else}\ 0\ \textrm{fi})$, que es exactamente lo mismo que $Q_c$
	\end{itemize}
	$\scalebox{1.3}{$\{I\wedge B\} \textbf{ ciclo } \{I\}$}$\medskip \\
	Queremos ver que vale la siguiente tripla de Hoare $\{I\wedge B\} \textbf{ ciclo } \{I\}$.\\
	Llamemos S1 a la primer instrucción del cuerpo del ciclo, S2 a la segunda:\\
	S1$: \textbf{if}\ (j\ mod\ 2=1\ \textbf{then}\ result:=result+s[j]\ \textbf{else}\ skip\ \textbf{endif};$\\
	S2$: j:=j+1$\\
	Lo primero que haremos es calcular $wp(ciclo,I)$.
	\begin{equation}wp(S1;S2,I)\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\end{equation}
	Antes de seguir, debemos calcular $wp(S2,I)$. Para eso usaremos el axioma 1:
	\begin{align*}
	wp(S2,I)&\stackrel{Ax1}{\equiv}def(j+1)\wedge_L I_{j+1}^{j}\\
		&\equiv true\wedge_L 0\leq j+1\leq |s| \wedge result=\sum_{i=0}^{j-1+1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi})\\
		&\equiv 0\leq j+1\leq |s| \wedge result=\sum_{i=0}^{j-1+1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))
	\end{align*}
	
	Volviendo a (4), reemplazamos $wp(S2,I)$ y nos queda:
	\begin{align*}
	wp(S1;S2,I)&\stackrel{Ax3}{\equiv}wp(S1,wp(S2,I))\\
	&\equiv  wp(S1,0\leq j+1\leq |s| \wedge result=\sum_{i=0}^{j-1+1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))\\
	&\equiv  wp(S1,I_{j+1}^{j})\\
	&\stackrel{Ax4}{\equiv}def(j\ mod\ 2=1)\wedge_L \Bigg(\Big((j\ mod\ 2=1)\wedge (wp(result:=result+s[j],I_{j+1}^{j}))\Big) 
   				\\&\vee \Big(\neg  (j\ mod\ 2=1)\wedge (wp(skip,I_{j+1}^{j}))\Big)\Bigg)\\
		&\stackrel{Ax1}{\equiv} True\wedge_L \Bigg(\Big((j\ mod\ 2=1)\wedge (wp(result:=result+s[j],I_{j+1}^{j}))\Big) 
   				\vee \Big(\neg  (j\ mod\ 2=1)\wedge I_{j+1}^{j})\Big)\Bigg)\\
		&\equiv  \Bigg(\Big((j\ mod\ 2=1)\wedge (wp(result:=result+s[j],I_{j+1}^{j}))\Big) 
   				\vee \Big(\neg  (j\ mod\ 2=1)\wedge I_{j+1}^{j})\Big)\Bigg)\\
   		&\equiv  \Bigg(\Big((j\ mod\ 2=1)\wedge (0\leq j+1\leq |s| \wedge result+s[j]=\sum_{i=0}^{j-1+1}
   			(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))\Big) 
   				\\&\vee \Big(\neg  (j\ mod\ 2=1)\wedge 0\leq j+1\leq |s| \wedge result=\sum_{i=0}^{j-1+1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))\Big)\Bigg)\\
	\end{align*}
	(ya se como sigue lo dejo asi para que quede mas corto)\\
	Una vez calculada la precondición más débil, debemos ver si $(I\wedge B)$ implican dicha precondición. Probamos cada
	parte por separado:
	\begin{itemize}
		\item $\Big((j\ mod\ 2=1)\wedge (0\leq j+1\leq |s| \wedge result+s[j]=\sum_{i=0}^{j-1+1}
   			(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))\Big) $\smallskip \\
		Supongo que vale la izquierda y entonces vale la derecha.
		\item $\Big(\neg  (j\ mod\ 2=1)\wedge 0\leq j+1\leq |s| \wedge result=\sum_{i=0}^{j-1+1}(\textrm{if}\ i\ mod\ 2=1\ \textrm{then}\ s[i]\ \textrm{else}\ 0\ \textrm{fi}))\Big)$\smallskip \\
		Supongo que vale la izquierda y entonces vale la derecha.\smallskip \\
		Como $(I\wedge B) \Rightarrow wp(ciclo,I)$, podemos afirmar que el cuerpo del ciclo preserva el invariante.
	\end{itemize}
\end{enumerate}
%\includegraphics[width=\linewidth]{pe.png}


\end{document}