
\documentclass{article}

\usepackage{a4wide}
\usepackage[utf8]{inputenc}
\usepackage{enumerate}
\usepackage{xspace}
\usepackage{longtable}
\usepackage{graphics}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{calc}
\usepackage{lmodern}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathdots}
\usepackage{mathtools}
\usepackage{multicol}
\usepackage{enumitem}
\usepackage{tasks}

\input{../macros/Algo1Macros}

\begin{document}

\practica{4}{Precondición más débil en SmallLang}

\paragraph{Ejercicio 1.} $\bigstar$ Calcular las siguientes expresiones, donde $a, b$ son variables 
reales, $i$ una variable entera y $A$ es una secuencia
de reales.

\begin{enumerate}[label=\alph*)]
\item def$(a + 1).$
\item def$(a/b).$
\item def$( \sqrt{a/b}).$
\item def$(A[i] + 1).$
\item def$(A[i + 2]).$
\item def$(0 \leq i \leq |A|).$
\item def$(0 \leq i \leq |A| \wedge_L A[i] \leq 0).$
\end{enumerate}

\subsection*{Respuestas}
Supongo que def$(x)\equiv True$,para todas las variables por lo expuesto en la teorica,
ya que de este modo se simplifica la notación.

\begin{enumerate}[label=\alph*)]
  \item def$(a + 1)\equiv$def$(a)\wedge$def$(1)\equiv True\wedge True\equiv True$
  \item def$(a/b)\equiv$ def$(a)\ \wedge \ $def$(b)\ \wedge \ b\neq 0\equiv b\neq 0$.
  \item def$( \sqrt{a/b})\equiv b\neq 0\wedge (a/b)\geq 0$.
  \item def$(A[i] + 1)\equiv 0\leq i < |A|$
  \item def$(A[i + 2])\equiv 0\leq i+2 < |A|$
  \item def$(0 \leq i \leq |A|)\equiv True$
  \item def$(0 \leq i \leq |A| \wedge_L A[i] \leq 0)\equiv i<|A|$
\end{enumerate}

\paragraph{Ejercicio 2.} Calcular las siguientes precondiciones más débiles, donde 
$a, b$ son variables reales, $i$ una variable entera y $A$ es
una secuencia de reales.

\begin{enumerate}[label=\alph*)]
\item $wp(\textbf{a := a+1}, a \geq 0).$
\item $wp(\textbf{a := a/b}, a \geq 0).$
\item $wp(\textbf{a := A[i]}, a \geq 0).$
\item $wp(\textbf{a := b*b}, a \geq 0).$
\item $wp(\textbf{b := b+1}, a \geq 0).$
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item 
		\begin{align*}
			wp(\textbf{a := a+1}, a \geq 0) &\equiv \textrm{def}(a+1)
				\wedge_L (a\geq 0)_{a+1}^a\\
			&\equiv True\wedge_L a+1\geq 0\\
			&\equiv a\geq -1
		\end{align*}
	\item
		\begin{align*}
			wp(\textbf{a := a/b}, a \geq 0) &\equiv \textrm{def}(a/b)\wedge_L 
		    \wedge_L (a\geq 0)_{a/b}^a \\
			&\equiv \textrm{def}(a)\wedge_L 
			\textrm{def}(b)\wedge_L b\neq 0 \wedge_L (a\geq 0)_{a/b}^a\\
			&\equiv True\wedge_L True \wedge_L b\neq 0\wedge_L  a/b\geq 0\\
			&\equiv b\neq 0 \wedge_L a \geq 0
		\end{align*}
	\item
		\begin{align*}
			wp(\textbf{a := A[i]}, a \geq 0) &\equiv \textrm{def}(A[i])
				\wedge_L (a\geq 0)_{A[i]}^a\\
			&\equiv (\textrm{def}(A)\wedge_L 
			\textrm{def}(i)) \wedge_L 0\leq i <|A| \wedge_L A[i]\geq 0\\
			&\equiv 0\leq i <|A| \wedge_L A[i]\geq 0
		\end{align*}
	\item
		\begin{align*}
			wp(\textbf{a := b*b}, a \geq 0) &\equiv \textrm{def}(b*b)
				\wedge_L (a\geq 0)_{b*b}^a\\
			&\equiv True\wedge_L b*b\geq 0\\
			&\equiv b*b\geq 0
		\end{align*}
	\item
		\begin{align*}
			wp(\textbf{b := b+1}, a \geq 0) &\equiv \textrm{def}(b+1)
				\wedge_L (a\geq 0)_{a}^a\\
			&\equiv True\wedge_L a\geq 0\\
			&\equiv a\geq 0
		\end{align*}
\end{enumerate}

\paragraph{Ejercicio 3.} $\bigstar$ Calcular las siguientes precondiciones más débiles, donde 
$a, b$ son variables reales, $i$ una variable entera y $A$
es una secuencia de reales.

\begin{enumerate}[label=\alph*)]
\item $wp(\textbf{a := a+1; b := a/2}, b \geq 0).$
\item $wp(\textbf{a := A[i] + 1; b := a*a}, b\neq 2).$
\item $wp(\textbf{a := A[i] + 1; a := b*b}, a \geq 0).$
\item $wp(\textbf{a := a-b; b := a+b}, a \geq 0 \wedge b \geq 0).$
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item
		
		\begin{align*}
		\color{blue}\{wp(\textbf{a := a+1; b := a/2}, b \geq 0)\} &\color{blue}
			\equiv \{(a+1)/2\geq 0\}\\
		\textbf{a := a+1;}\\
		\color{blue}\{wp(\textbf{b := a/2},Q)\}&\color{blue}\equiv \{a/2\geq 0\}\\
		\textbf{b := a/2;}\\
		\color{blue}\{Q:b \geq 0\}
		\end{align*}
		
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{a := A[i] + 1; b := a*a}, b\neq 2)\} &\color{blue}
			\equiv \{0\leq i<|A|\wedge_L (A[i] + 1)*(A[i] + 1)\neq 0\}\\
		\textbf{a := A[i] + 1;}\\
		\color{blue}\{wp(\textbf{b := a*a},Q)\}&\color{blue}\equiv \{a*a\neq 0\}\\
		\textbf{b := a*a;}\\
		\color{blue}\{Q:b \neq 0\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{a := A[i] + 1; a := b*b}, a \geq 0)\} &\color{blue}
			\equiv \{0\leq i<|A|\wedge b\geq 0\}\\
		\textbf{a := A[i] + 1;}\\
		\color{blue}\{wp(\textbf{a := b*b},Q)\}&\color{blue}\equiv \{b\geq 0\}\\
		\textbf{a := b*b;}\\
		\color{blue}\{Q:b \geq 0\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{a := a-b; b := a+b}, a \geq 0 \wedge b \geq 0)\} &\color{blue}
			\equiv \{a-b \geq 0 \wedge a+b \geq 0\}\\
		\textbf{a := a-b;}\\
		\color{blue}\{wp(\textbf{b := a+b},Q)\}&\color{blue}
			\equiv \{a \geq 0 \wedge a+b \geq 0\}\\
		\textbf{b := a+b;}\\
		\color{blue}\{Q:a \geq 0 \wedge b \geq 0\}
		\end{align*}
\end{enumerate}

\paragraph{Ejercicio 4.} $\bigstar$ Sea $Q \equiv (\forall j :\mathbb{Z})(0 \leq j < |A| \rightarrow_L
 A[j] \geq 0)$. Calcular las 
siguientes precondiciones más débiles, donde i es
una variable entera y A es una secuencia de reales.

\begin{enumerate}[label=\alph*)]
\item $wp(\textbf{A[i] := 0}, Q).$
\item $wp(\textbf{A[i+2] := 0}, Q).$
\item $wp(\textbf{A[i+2] := -1}, Q).$
\item $wp(\textbf{A[i] := 2 * A[i]}, Q).$
\item $wp(\textbf{A[i] := A[i-1]}, Q).$
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{A[i] := 0 },Q)\} &\color{blue}
			\equiv \{0\leq i<|A|\wedge Q\}\\
		\textbf{A[i] := 0}\\
		\color{blue}\{Q\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{A[i+2] := 0 },Q)\} &\color{blue}
			\equiv \{0\leq i+2<|A|\wedge Q\}\\
		\textbf{A[i+2] := 0}\\
		\color{blue}\{Q\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{A[i+2] := -1 },Q)\} &\color{blue}
			\equiv \{0\leq i+2<|A|\wedge Q\wedge \textbf{Esto no pasa la post nunca}\}\\
		\textbf{A[i+2] := -1}\\
		\color{blue}\{Q\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{A[i] := 2 * A[i] },Q)\} &\color{blue}
			\equiv \{0\leq i<|A|\wedge A[i]\geq 0 \wedge Q\}\\
		\textbf{A[i] := 2 * A[i]}\\
		\color{blue}\{Q\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(\textbf{A[i] := A[i-1] },Q)\} &\color{blue}
			\equiv \{0\leq i-1<|A|\wedge Q\}\\
		\textbf{A[i] := A[i-1]}\\
		\color{blue}\{Q\}
		\end{align*}
\end{enumerate}

\paragraph{Ejercicio 5.} Calcular wp(S, Q), para los siguientes pares de programas S y postcondiciones Q.

\begin{enumerate}[label=\alph*)]
\item $S \equiv i := i + 1$\\
  $Q \equiv (\forall j :Z)(0 \leq j < |A| \rightarrow_L A[j] \neq 0)$
\item $S \equiv A[0] := 4$\\
   $Q \equiv (\forall j :Z)(0 \leq j < |A| \rightarrow_L A[j] \neq 0)$
\item $S \equiv A[2] := 4$\\
   $Q \equiv (\forall j :Z)(0 \leq j < |A| \rightarrow_L A[j] \neq 0)$
\item $S \equiv A[i] := A[i+1] - 1$\\
   $Q \equiv (\forall j :Z)(0 < j < |A| \rightarrow_L A[j] \geq A[j - 1])$
\item $S \equiv A[i] := A[i+1] - 1$\\
   $Q \equiv (\forall j :Z)(0 < j < |A| \rightarrow_L A[j] \leq A[j - 1])$
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item
		\begin{align*}
		\color{blue}\{wp(S,Q)\} &\color{blue}
			\equiv \{Q\}\\
		S \equiv i &:= i + 1\\
		\color{blue}\{Q \equiv  (\forall j :Z)(0 \leq j & \color{blue} <|A| \rightarrow_L A[j] \neq 0)\}
		\end{align*}
		Y a mi que me contas, no hace nada esto.
	\item
		\begin{align*}
		\color{blue}\{wp(S,Q)\} &\color{blue}
			\equiv \{\}\\
		S \equiv A[0] &:= 4\\
		\color{blue}\{Q \equiv (\forall j :Z)(0 \leq j & \color{blue}< |A| 
			\rightarrow_L A[j] \neq 0)\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(S,Q)\} &\color{blue}
			\equiv \{\}\\
		S \equiv A[2] &:= 4\\
		\color{blue}\{Q \equiv (\forall j :Z)(0 \leq j & \color{blue}< |A| 
			\rightarrow_L A[j] \neq 0)\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(S,Q)\} &\color{blue}
			\equiv \{\}\\
		S \equiv A[i] &:= A[i+1] - 1\\
		\color{blue}\{Q \equiv (\forall j :Z)(0 < j & \color{blue}< |A| 
			\rightarrow_L A[j] \geq A[j - 1])\}
		\end{align*}
	\item
		\begin{align*}
		\color{blue}\{wp(S,Q)\} &\color{blue}
			\equiv \{\}\\
		S \equiv A[i] &:= A[i+1] - 1\\
		\color{blue}\{Q \equiv (\forall j :Z)(0 < j & \color{blue}< |A| 
			\rightarrow_L A[j] \leq A[j - 1])\}
		\end{align*}
\end{enumerate}

\paragraph{Ejercicio 6.}. Escribir programas para los siguientes problemas y demostrar 
formalmente su corrección usando la precondición
más débil.

\begin{enumerate}[label=\alph*)]
\item \textbf{proc problema1 }(inout a: Z) {\\
   \hspace*{6mm} \textbf{Pre }$\{a = a_0 \wedge a \geq 0\}$\\
   \hspace*{6mm} \textbf{Post }$\{a = a_0 + 2\}$\\
   }

\item \textbf{proc problema2 }(in a: Z, out b: Z) {\\
   \hspace*{6mm} \textbf{Pre }$\{a 6= 0\}$\\
   \hspace*{6mm} \textbf{Post }$\{b = a + 3\}$\\
   }

\item \textbf{proc problema3 }(in a: Z, in b: Z, out c: Z) {\\
   \hspace*{6mm} \textbf{Pre }$\{true\}$\\
   \hspace*{6mm} \textbf{Post }$\{c = a + b\}$\\
   }

\item \textbf{proc problema4 }(in a: seqhZi, in i: Z, out result: Z) {\\
   \hspace*{6mm} \textbf{Pre }$\{0 \leq i < |a|\}$\\
   \hspace*{6mm} \textbf{Post }$\{result = 2 * a[i]\}$\\
   }

\item \textbf{proc problema5 }(in a: seqhZi, in i: Z, out result: Z) {\\
   \hspace*{6mm} \textbf{Pre }$\{0 \leq i \wedge i + 1 < |a|\}$\\
   \hspace*{6mm} \textbf{Post }$\{result = a[i] + a[i + 1]\}$\\
   }
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item
	\item
	\item
	\item
	\item
\end{enumerate}
                                                            
\paragraph{Ejercicio 7.} $\bigstar$ Calcular wp(S, Q), para los siguientes pares de programas S y postcondiciones Q.

\begin{enumerate}[label=\alph*)]
\item $S \equiv$\\
   if $( a < 0 )$\\
      $b := a$\\
   else\\
      $b := -a$\\
   endif\\

   $Q \equiv (b = -|a|)$\\
\item $S \equiv$\\
   if $( a < 0 )$\\
     $ b := a$\\
   else\\
     $ b := -a$\\
   endif\\

   $Q \equiv (b = |a|)$\\

\item $S \equiv$\\
   if $( i > 0 )$\\
     $ s [ i ] := 0$\\
   else\\
     $ s [ 0 ] := 0$\\
   endif\\

   $Q \equiv (\forall j :Z)(0 \leq j < |s| \rightarrow_L s[j] \geq 0)$\\
\item $S \equiv$
   if $( i > 1 )$\\
      $s [ i ] := s [ i -1]$\\
   else\\
     $ s [ i ] := 0$\\
   endif\\

   $Q \equiv (\forall j :Z)(1 \leq j < |s| \rightarrow_L s[j] = s[j - 1])$\\

\item $S \equiv$\\
   if $( s [ i ] < 0 )$\\
     $ s [ i ] := -s [ i ]$\\
   else\\
      $skip$\\
   endif\\

   $Q \equiv 0 \leq i < |s| \wedge_L s[i] \geq 0$\\
\item $S \equiv$\\
   if $( s [ i ] > 0 )$\\
      $s [ i ] := -s [ i ]$\\
   else\\
      $skip$\\
   endif\\

   $Q \equiv (\forall j :Z)(0 \leq j < |s| \rightarrow_L s[j] \geq 0)$
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item
	\item
	\item
	\item
	\item
\end{enumerate}
                                                          
\paragraph{Ejercicio 8.} $\bigstar$ Escribir programas para los siguientes problemas y demostrar 
formalmente su corrección usando la precon-dición más débil.

\begin{enumerate}[label=\alph*)]
\item \textbf{proc problema1 }(in s: seqhZi, in i: Z, inout a: Z) {\\
                                   
   \hspace*{6mm} \textbf{Pre }$\{0 \leq i < |s| \wedge_L a = j=0 s[j]\}$\\
                    
   \hspace*{6mm} \textbf{Post }$\{a = j=0 s[j]\}$\\
   }

\item \textbf{proc problema2 }(in s: seqhZi, in i: Z, inout a: Z) {\\
                                  
   \hspace*{6mm} \textbf{Pre }$\{0 \leq i < |s| \wedge a = j=0 s[j]\}$\\
                    
   \hspace*{6mm} \textbf{Post }$\{a = j=1 s[j]\}$\\
   }

\item \textbf{proc problema3 }(in s: seqhZi, in i: Z, out res: Bool) {\\
   \hspace*{6mm} \textbf{Pre }$\{0 \leq i < |s| \wedge 
   		(\forall j :Z)(0 \leq j < i \rightarrow_L s[j] \geq 0)\}$\\
   \hspace*{6mm} \textbf{Post }$\{res = true \leftrightarrow (\forall j :Z)
          (0 \leq j \leq i \rightarrow_L s[j] \geq 0)\}$\\
   }

\item \textbf{proc problema4 }(in s: seqhZi, in i: Z, inout a: Z) {\\
                                   
   \hspace*{6mm} \textbf{Pre }${0 \leq i < |s| \wedge_L a = j=0 (if s[j] 6= 0 
   		then 1 else 0 fi)}$\\
                   
   \hspace*{6mm} \textbf{Post }$\{a = j=0 (if s[j] 6= 0 then 1 else 0 fi)\}$\\
   }

\item \textbf{proc problema5 }(in s: seqhZi, in i: Z, inout a: Z) {\\
                                  
    \hspace*{6mm} \textbf{Pre }$\{0 < i \leq |s| \wedge_L a = j=1 (if s[j] 6= 0 
    then 1 else 0 fi)\}$\\
                    
   \hspace*{6mm} \textbf{Post }$\{a = j=0 (if s[j] 6= 0 then 1 else 0 fi)\}$\\
   }                     
\end{enumerate}

\subsection*{Respuestas}

\begin{enumerate}[label=\alph*)]
	\item
	\item
	\item
	\item
	\item
\end{enumerate}

\end{document}